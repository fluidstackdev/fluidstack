# Migration `20190618213953-init`

This migration has been generated by Flavian DESVERNE at 6/18/2019, 9:39:53 PM.
You can check out the [state of the datamodel](./datamodel.prisma) after the migration.

## Database Steps

```sql
CREATE TABLE "next"."Collection"("id" TEXT NOT NULL  ,"name" TEXT NOT NULL DEFAULT '' ,"rules" TEXT   REFERENCES CollectionRuleSet(id),PRIMARY KEY ("id"));

CREATE TABLE "next"."CollectionRuleSet"("id" TEXT NOT NULL  ,"appliesDisjunctively" BOOLEAN NOT NULL DEFAULT false ,PRIMARY KEY ("id"));

CREATE TABLE "next"."CollectionRule"("id" TEXT NOT NULL  ,"field" TEXT NOT NULL DEFAULT 'TYPE' ,"relation" TEXT NOT NULL DEFAULT 'CONTAINS' ,"value" TEXT NOT NULL DEFAULT '' ,"collectionRuleSet" TEXT   REFERENCES CollectionRuleSet(id),PRIMARY KEY ("id"));

CREATE TABLE "next"."ProductType"("id" TEXT NOT NULL  ,"name" TEXT NOT NULL DEFAULT '' ,PRIMARY KEY ("id"));

CREATE TABLE "next"."Product"("id" TEXT NOT NULL  ,"name" TEXT NOT NULL DEFAULT '' ,"slug" TEXT NOT NULL DEFAULT '' ,"description" TEXT NOT NULL DEFAULT '' ,"type" TEXT   REFERENCES ProductType(id),"brand" TEXT NOT NULL  REFERENCES Brand(id),"thumbnail" TEXT   REFERENCES Image(id),PRIMARY KEY ("id"));

CREATE TABLE "next"."Brand"("id" TEXT NOT NULL  ,"name" TEXT NOT NULL DEFAULT '' ,PRIMARY KEY ("id"));

CREATE TABLE "next"."Attribute"("id" TEXT NOT NULL  ,"key" TEXT NOT NULL DEFAULT '' ,"value" TEXT NOT NULL DEFAULT '' ,PRIMARY KEY ("id"));

CREATE TABLE "next"."OptionValue"("id" TEXT NOT NULL  ,"name" TEXT NOT NULL DEFAULT '' ,"option" TEXT NOT NULL  REFERENCES Option(id),"variant" TEXT   REFERENCES Variant(id),PRIMARY KEY ("id"));

CREATE TABLE "next"."Option"("id" TEXT NOT NULL  ,"name" TEXT NOT NULL DEFAULT '' ,"isColor" BOOLEAN   ,PRIMARY KEY ("id"));

CREATE TABLE "next"."Variant"("id" TEXT NOT NULL  ,"price" INTEGER NOT NULL DEFAULT 0 ,"availableForSale" BOOLEAN   ,"sku" TEXT   ,"product" TEXT   REFERENCES Product(id),PRIMARY KEY ("id"));

CREATE TABLE "next"."Image"("id" TEXT NOT NULL  ,"url" TEXT NOT NULL DEFAULT '' ,"variant" TEXT   REFERENCES Variant(id),PRIMARY KEY ("id"));

CREATE TABLE "next"."_CollectionToProduct"("A" TEXT NOT NULL  REFERENCES Collection(id),"B" TEXT NOT NULL  REFERENCES Product(id));

CREATE TABLE "next"."_AttributeToProduct"("A" TEXT NOT NULL  REFERENCES Attribute(id),"B" TEXT NOT NULL  REFERENCES Product(id));
```

## Changes

```diff
diff --git datamodel.mdl datamodel.mdl
migration ..20190618213953-init
--- datamodel.dml
+++ datamodel.dml
@@ -1,0 +1,110 @@
+datasource db {
+  provider = "sqlite"
+  url      = "file:db/next.db"
+  default  = true
+}
+
+generator photon {
+  provider = "photonjs"
+}
+
+generator nexus_prisma {
+  provider = "nexus-prisma"
+}
+
+type ID = String @id @default(cuid())
+
+model Collection {
+  id       ID
+  name     String
+  rules    CollectionRuleSet?
+  products Product[]
+}
+
+model CollectionRuleSet {
+  id                   ID
+  rules                CollectionRule[]
+  appliesDisjunctively Boolean
+}
+
+model CollectionRule {
+  id       ID
+  field    CollectionRuleField
+  relation CollectionRuleRelation
+  value    String
+}
+
+enum CollectionRuleField {
+  TYPE
+  TITLE
+  PRICE
+}
+
+enum CollectionRuleRelation {
+  CONTAINS
+  ENDS_WITH
+  EQUALS
+  GREATER_THAN
+  LESS_THAN
+  NOT_CONTAINS
+  NOT_EQUALS
+  STARTS_WITH
+}
+
+model ProductType {
+  id   ID
+  name String
+}
+
+model Product {
+  id          ID
+  name        String
+  brand       Brand
+  slug        String       @unique
+  thumbnail   Image?
+  description String
+  type        ProductType?
+  variants    Variant[]
+  collections Collection[]
+  attributes  Attribute[]
+}
+
+model Brand {
+  id       ID
+  name     String
+  products Product[]
+}
+
+model Attribute {
+  id       ID
+  key      String
+  value    String
+  products Product[]
+}
+
+model OptionValue {
+  id     ID
+  name   String
+  option Option
+}
+
+model Option {
+  id      ID
+  name    String
+  values  OptionValue[]
+  isColor Boolean?
+}
+
+model Variant {
+  id               ID
+  optionValues     OptionValue[]
+  price            Int
+  availableForSale Boolean?      @default(false)
+  sku              String?
+  images           Image[]
+}
+
+model Image {
+  id  ID
+  url String
+}
```

## Photon Usage

You can use a specific Photon built for this migration (20190618213953-init)
in your `before` or `after` migration script like this:

```ts
import Photon from '@generated/photon/20190618213953-init'

const photon = new Photon()

async function main() {
  const result = await photon.users()
  console.dir(result, { depth: null })
}

main()

```
